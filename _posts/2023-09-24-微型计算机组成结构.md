---
title: 微型计算机组成结构
date: 2023-09-24 15:22:33 +0800
categories: [Read, Linux内核0.11]
math: true
mermaid: true
---


> 基于Inter80X86中央处理器
{: .prompt-info }

注：`PC/AT`指代具有`80386`或以上`CPU`的`IBM PC`及其兼容微机


## 1. 微型计算机组成原理

### 传统IBM-PC机

![传统IBM-PC及其兼容计算机组成框图](/assets/img/posts/Read/Linux内核0.11/传统IBM-PC及其兼容计算机组成框图.png "传统IBM-PC及其兼容计算机组成框图")
- 本地总线（内部总线）
	- CPU通过内部总线与系统其他部分进行数据通信
	- |组成|说明|
	   |:--:|:--:|
	   |地址线|提供内存或I/O设备的地址，即指明需要读/写数据的具体位置|
	   |数据线|在CPU和内存或I/O设备之间提供数据传输的通道|
	   |控制线|负责指挥执行的具体读/写操作|
	 - 对于`80386CPU`而言，地址线和数据线都为32根，寻址空间范围是0到4GB
	 - 总线插槽（标准连接接口）
		 - `ISA`、`EISA`、`PCI`、`AGP`……
- 控制器和存储器
	- 每个控制器是以一块大规模集成电路芯片为主组成的功能电路
	- 其接口通常都集成在主板上
	- 控制卡（适配器）通过扩展插槽与主板上系统总线连接

### 现代PC机

![现代PC机芯片集框](/assets/img/posts/Read/Linux内核0.11/现代PC机芯片集框.png "现代PC机芯片集框")
- 北桥芯片（MCH）
	- 连接CPU、内存和AGP视频接口
- 南桥芯片（ICH）
	- 管理低、中速组件


## 2. I/O端口和访问控制方式

### I/O端口

> 实际上就是控制器的地址，简称端口

- 数据端口：访问数据
- 命令端口：输出命令
- 状态端口：访问控制器执行状态

### 寻址方式

- **统一编址**（存储映像编址）
	- 把I/O控制器中的端口地址归入存储器寻址地址空间范围
	- CPU访问一个端口的操作与访问内存的操作一样，也使用访问内存的指令
- **独立编址**
	- 采用一个独立的I/O地址空间对控制设备中的寄存器进行寻址和访问

### 接口访问控制

- **程序循环查询方式**
	- 消耗CPU资源
	- *Linux中，很少采用*
- **中断处理方式**
	- 需要中断控制器的支持
	- I/O设备通过中断向CPU提出请求，CPU暂时中断当前执行的程序转而去执行相应的I/O中断处理服务程序
		- CPU通过中断向量表寻址相应的中断处理服务程序的入口地址
	- *Linux中，大多数设备I/O控制采用此方式*
- **DMA传输方式**
	- 数据传送由DMA控制器进行，无需CPU干预
	- *Linux中，软盘驱动程序使用中断和DMA方式配合传输数据*


## 3. 存储器和BIOS

### 主存储器

> 简称内存

- 该书目前讨论的是32位CPU（即`PC/AT`计算机），寻址范围达到4GB
- 计算机上电初始化，物理内存被设置成从地址0开始的连续区域。
- 
	|地址|存储内容|
	|:--:|:--:|
	|0xA0000~0xFFFFF|I/O设备|
	|0xFFFE0000~0xFFFFFFFF|BIOS程序|
	|其余地址|系统内存|
- 而Linux的内存使用有些不同，具体见下图
![PC/AT机内存使用区域](/assets/img/posts/Read/Linux内核0.11/PCAT机内存使用区域.png "PC/AT机内存使用区域")

### BIOS

> 基本输入/输出程序

- 计算机开机时执行系统各部分的自检，建立起操作系统需要使用的各种配置表，例如中断向量表、硬盘参数表等

### CMOS存储器

- 存放计算机的实时时钟信息和系统硬件配置信息
- 通常和实时时钟芯片集成到一起
- CMOS内存的地址空间在基本内存地址空间之外，需要使用I/O指令来访问（独立编址）


## 4. 控制器和控制卡

### 中断控制器

- 采用两片级联的`8259A`可编程中断控制芯片

### DMA控制器

- `Intel8237`芯片或其兼容芯片实现

### 定时/计数器

- `Intel8253/8254`芯片
- 提供3个独立的16位计数器通道

### 键盘控制器

- 键盘上的键盘编码器的处理器
	- 专门用来扫描手机所有按键按下和松开的状态信息（扫描码），并发送到主机主板上的键盘控制器中
	- 接通码、断开码
- 作用
	- 该控制器专门对接收到的键盘扫描码进行解码
	- 解码后的数据发送到os的键盘数据队列中
- 扫描码集
	- 整个键盘上所有按键的接通和断开码（都是不相同的）
	- 包括XT键盘扫描码集、AT键盘扫描码集、PS/2键盘扫描码集

### 串行控制卡

- 串行通信
	- 线路上以比特位数据流一次一个bit进行传输
	- 分类
		- 异步
			- 以一个字符作为一帧进行传输
		- 同步
			- 以多个字符或字节组成的序列作为一帧进行传输
- 异步串行传输格式
	- 传号：传送1
	- 空号：传送0

![异步串行通信字符传输格式](/assets/img/posts/Read/Linux内核0.11/异步串行通信字符传输格式.png "异步串行通信字符传输格式")
 - PC机上通常待用2个符合RS-232C标准的串行接口，并使用通用异步接收/发送器控制芯片UART组成的串行控制器来处理串行数据的收发工作

### 显示控制

- `MDA`显示标准
	- 单色显示适配器，仅支持黑白两色
	- 支持独有的文本显示方式
- `CGA`显示标准
	- 彩色图形适配器
	- 支持7种彩色和图形显示方式
- `EGA/VGA`显示标准
	- 增强型图形适配器`EGA`、视频图形阵列`VGA`
	- 兼容和支持上述两种标准，还支持其他在图形显示方面的增强显示方式

### 软盘和硬盘控制器

- 软盘
	- 软盘片、软盘驱动器
	- 易损坏、逐渐淘汰
- 硬盘（外存）
	- 盘片、驱动器（金属盘片通常固定在驱动器中，不可拆卸）
	
